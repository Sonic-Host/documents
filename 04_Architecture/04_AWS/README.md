# AWS 基盤のアーキテクチャ定義書

本章では AWS 基盤の処理方式にフォーカスした内容を記載する。

## 構成概要

### 基盤構成の全体方針

本システムはサーバレスかつマイクロサービスの構成で作成する。

### 概要図

![AWS-Architecture](images/CloudArchitecture.svg)

## データ管理方針

### リソース情報

データについては DynamoDB にて保管する。  
Lambda が生成される単位でセットで DynamoDB を作成する。

### アプリ資材

資材については S3 にて保管する。  
S3 の情報をクライアントが照会するときには CloudFront を経由する。

### コンテンツ情報について

コンテンツ情報については S3 に保管する。  
コンテンツ情報を参照する際には CloudFlare 経由で参照することになる。

### ログ情報

ログ情報については S3 に保管する。

#### 保管期間

保管期間については以下のように定義する。

- S3 : １０日間
- S3-IA : ２０日間
- S3-Glacier : ６０日間

合計で、９０日間（３か月相当）保管する想定

## API 基盤構築方針

API 基盤とはクライアントアプリから API 打鍵するときの API の受け口となる基盤のことを示す。

### 構築方法

構築方法としては、[aws-amplify](https://aws.amazon.com/jp/amplify/)を利用することを想定する。

環境や API-GW 自体の設定など基本的なな情報を設定したのちに、以下の情報については Swagger より情報を抽出し、自動で構築されるようにする。

- API-GW の IF 定義
- Lambda
- DynamoDB

### 性能の決定方法

性能については事前に値を設定はせず、ユーザの利用状況に応じて可変とする。

## バッチ基盤構築方針

バッチ基盤環境としては[AWS-BATCH](https://aws.amazon.com/jp/batch/)を利用する。  
インスタンスの種類としては Fargate を利用する。

コンテンツ作成については、毎日定時の時間でバッチを起動させるような仕組みで実現する。

※コンテンツ作成以外の簡易的なバッチについてはバッチの種類ごとに Lambda で実行する。

## セキュリティ方針

セキュリティの方針について記載する。  
基本的に AWS が記載しているベストプラクティスに沿って構築していくが、プロジェクト固有の考え方について記載する。

### エンドポイントセキュリティ

API-GW については AWS-WAF と AWS-Shield を利用する。
