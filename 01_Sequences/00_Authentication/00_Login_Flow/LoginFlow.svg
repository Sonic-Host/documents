<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1810px" preserveAspectRatio="none" style="width:1113px;height:1810px;background:#FFFFFF;" version="1.1" viewBox="0 0 1113 1810" width="1113px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60" x="528" y="27.9951">ログイン</text><rect fill="#FFFFFF" height="1570.6484" style="stroke:#181818;stroke-width:1.0;" width="10" x="299" y="149.7266"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="292.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="659.5234"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="762.0547"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="549" y="791.1875"/><rect fill="#FFFFFF" height="57.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="163.7266"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="975.9844"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1047.1172"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1118.25"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1475.7109"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1620.2422"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="989.9844"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1061.1172"/><rect fill="#FFFFFF" height="176.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1132.25"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1634.2422"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="893" y="192.8594"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1022" y="1489.7109"/><rect fill="none" height="521.1953" style="stroke:#000000;stroke-width:1.5;" width="589.5" x="10" y="363.2578"/><rect fill="none" height="186.7344" style="stroke:#000000;stroke-width:1.5;" width="520" x="20" y="429.5234"/><rect fill="none" height="332.1953" style="stroke:#000000;stroke-width:1.5;" width="1087" x="20" y="1380.1797"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="303.5" x2="303.5" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="548.5" x2="548.5" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="650.5" x2="650.5" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="769.5" x2="769.5" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="898" x2="898" y1="118.5938" y2="1729.375"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1027" x2="1027" y1="118.5938" y2="1729.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="30" y="115.292">ユーザ</text><ellipse cx="54" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M54,58.7969 L54,85.7969 M41,66.7969 L67,66.7969 M54,85.7969 L41,100.7969 M54,85.7969 L67,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="30" y="1741.3701">ユーザ</text><ellipse cx="54" cy="1753.1719" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M54,1761.1719 L54,1788.1719 M41,1769.1719 L67,1769.1719 M54,1788.1719 L41,1803.1719 M54,1788.1719 L67,1803.1719 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="240.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="248" y="90.9951">クライアント端末</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="247.5" y="107.292">(PCまたはスマホ)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="240.5" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="248" y="1748.3701">クライアント端末</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="247.5" y="1764.667">(PCまたはスマホ)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="508.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="521" y="90.9951">認証基盤</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="515.5" y="107.292">(Cognito)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="508.5" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="521" y="1748.3701">認証基盤</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="515.5" y="1764.667">(Cognito)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="599.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="635.5" y="90.9951">CDN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="606.5" y="107.292">(CloudFront)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="599.5" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="635.5" y="1748.3701">CDN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="606.5" y="1764.667">(CloudFront)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="712.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="720.5" y="90.9951">SonicHost API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="719.5" y="107.292">(API-Gateway)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="712.5" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="720.5" y="1748.3701">SonicHost API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="719.5" y="1764.667">(API-Gateway)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="849" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="856" y="90.9951">SPA資材格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="884" y="107.292">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="849" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="856" y="1748.3701">SPA資材格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="884" y="1764.667">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="957" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="964" y="90.9951">静的コンテンツ格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1013" y="107.292">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="957" y="1728.375"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="964" y="1748.3701">静的コンテンツ格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1013" y="1764.667">(S3)</text><rect fill="#FFFFFF" height="1570.6484" style="stroke:#181818;stroke-width:1.0;" width="10" x="299" y="149.7266"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="292.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="659.5234"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="762.0547"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="549" y="791.1875"/><rect fill="#FFFFFF" height="57.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="163.7266"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="975.9844"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1047.1172"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1118.25"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1475.7109"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1620.2422"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="989.9844"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1061.1172"/><rect fill="#FFFFFF" height="176.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1132.25"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1634.2422"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="893" y="192.8594"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1022" y="1489.7109"/><polygon fill="#181818" points="287,145.7266,297,149.7266,287,153.7266,291,149.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="61" y="144.6606">管理画面起動</text><polygon fill="#181818" points="634,159.7266,644,163.7266,634,167.7266,638,163.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="163.7266" y2="163.7266"/><polygon fill="#181818" points="881,188.8594,891,192.8594,881,196.8594,885,192.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="887" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="663" y="187.7935">バンドル資材要求</text><polygon fill="#181818" points="667,202.8594,657,206.8594,667,210.8594,663,206.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="897" y1="206.8594" y2="206.8594"/><polygon fill="#181818" points="320,216.8594,310,220.8594,320,224.8594,316,220.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="220.8594" y2="220.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="249.9922" y2="249.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="249.9922" y2="262.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="262.9922" y2="262.9922"/><polygon fill="#181818" points="320,258.9922,310,262.9922,320,266.9922,316,262.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="316" y="244.9263">バンドル資材読み込み</text><polygon fill="#181818" points="532,288.125,542,292.125,532,296.125,536,292.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="292.125" y2="292.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="316" y="287.0591">トークンチェック用公開鍵要求</text><polygon fill="#181818" points="320,302.125,310,306.125,320,310.125,316,306.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="548" y1="306.125" y2="306.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="335.2578" y2="335.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="335.2578" y2="348.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="348.2578" y2="348.2578"/><polygon fill="#181818" points="320,344.2578,310,348.2578,320,352.2578,316,348.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="330.1919">トークンチェック</text><path d="M10,363.2578 L76,363.2578 L76,370.3906 L66,380.3906 L10,380.3906 L10,363.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="521.1953" style="stroke:#000000;stroke-width:1.5;" width="589.5" x="10" y="363.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="25" y="376.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="231" x="91" y="375.4683">[トークン取得失敗 or トークンチェック失敗]</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="401.5234" y2="401.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="401.5234" y2="414.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="414.5234" y2="414.5234"/><polygon fill="#181818" points="320,410.5234,310,414.5234,320,418.5234,316,414.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="396.4575">ログイン画面表示</text><path d="M20,429.5234 L86,429.5234 L86,436.6563 L76,446.6563 L20,446.6563 L20,429.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="186.7344" style="stroke:#000000;stroke-width:1.5;" width="520" x="20" y="429.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="35" y="442.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="101" y="441.7339">[パスワード忘れた場合]</text><polygon fill="#181818" points="287,478.9219,297,482.9219,287,486.9219,291,482.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="482.9219" y2="482.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="61" y="462.7231">「パスワードを忘れた場合はこちら」</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="61" y="477.856">をクリック</text><rect fill="#ADFF2F" height="23" style="stroke:#181818;stroke-width:0.5;" width="216" x="314" y="495.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="318" y="511.9888">パスワードリマインダフローを参照</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="540" y1="525.0547" y2="525.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="25" y="535.2651">[新規会員登録の場合]</text><polygon fill="#181818" points="287,571.125,297,575.125,287,579.125,291,575.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="575.125" y2="575.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="61" y="554.9263">「会員登録はこちら」</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="61" y="570.0591">をクリック</text><rect fill="#ADFF2F" height="23" style="stroke:#181818;stroke-width:0.5;" width="138" x="314" y="588.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="318" y="604.1919">会員登録フローを参照</text><polygon fill="#181818" points="532,655.5234,542,659.5234,532,663.5234,536,659.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="659.5234" y2="659.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="639.3247">ログイン確立要求</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="316" y="654.4575">(Initiate Auth)</text><polygon fill="#181818" points="320,684.6563,310,688.6563,320,692.6563,316,688.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="314" x2="548" y1="688.6563" y2="688.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="326" y="683.5903">session等</text><polygon fill="#181818" points="287,713.7891,297,717.7891,287,721.7891,291,717.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="717.7891" y2="717.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="61" y="712.7231">ユーザ名・パスワード入力</text><polygon fill="#181818" points="532,758.0547,542,762.0547,532,766.0547,536,762.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="762.0547" y2="762.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="316" y="741.856">認証(トークン発行依頼)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="316" y="756.9888">(Responed to Auth Challenge)</text><polygon fill="#181818" points="537,787.1875,547,791.1875,537,795.1875,541,791.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="543" y1="791.1875" y2="791.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="316" y="786.1216">トークンチェック用公開鍵要求</text><polygon fill="#181818" points="320,801.1875,310,805.1875,320,809.1875,316,805.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="543" y1="805.1875" y2="805.1875"/><polygon fill="#181818" points="320,830.3203,310,834.3203,320,838.3203,316,834.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="314" x2="548" y1="834.3203" y2="834.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="326" y="829.2544">トークン</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="863.4531" y2="863.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="863.4531" y2="876.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="876.4531" y2="876.4531"/><polygon fill="#181818" points="320,872.4531,310,876.4531,320,880.4531,316,876.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="858.3872">トークンチェック</text><rect fill="#87CEEB" height="53" style="stroke:#181818;stroke-width:0.5;" width="392" x="314" y="896.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="384" x="318" y="912.52">ログイン直後は以下のAPIを打鍵してグローバルな情報を取り込む</text><ellipse cx="323.5" cy="923.2188" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="330" y="927.6528">ユーザ情報取得API</text><ellipse cx="323.5" cy="938.3516" fill="#000000" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="330" y="942.7856">サイト情報取得API</text><polygon fill="#181818" points="634,971.9844,644,975.9844,634,979.9844,638,975.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="975.9844" y2="975.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="316" y="970.9185">ユーザ情報取得API</text><polygon fill="#181818" points="753,985.9844,763,989.9844,753,993.9844,757,989.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="989.9844" y2="989.9844"/><polygon fill="#181818" points="667,999.9844,657,1003.9844,667,1007.9844,663,1003.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1003.9844" y2="1003.9844"/><polygon fill="#181818" points="320,1013.9844,310,1017.9844,320,1021.9844,316,1017.9844" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1017.9844" y2="1017.9844"/><polygon fill="#181818" points="634,1043.1172,644,1047.1172,634,1051.1172,638,1047.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1047.1172" y2="1047.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="111" x="316" y="1042.0513">サイト情報取得API</text><polygon fill="#181818" points="753,1057.1172,763,1061.1172,753,1065.1172,757,1061.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="1061.1172" y2="1061.1172"/><polygon fill="#181818" points="667,1071.1172,657,1075.1172,667,1079.1172,663,1075.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1075.1172" y2="1075.1172"/><polygon fill="#181818" points="320,1085.1172,310,1089.1172,320,1093.1172,316,1089.1172" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1089.1172" y2="1089.1172"/><polygon fill="#181818" points="634,1114.25,644,1118.25,634,1122.25,638,1118.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1118.25" y2="1118.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="316" y="1113.1841">規約チェックAPI</text><polygon fill="#181818" points="753,1128.25,763,1132.25,753,1136.25,757,1132.25" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="1132.25" y2="1132.25"/><rect fill="#87CEEB" height="53" style="stroke:#181818;stroke-width:0.5;" width="445" x="661" y="1145.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="665" y="1161.3169">CORS回避のため、API打鍵はCloudFrontを通す</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="665" y="1176.4497">また、API-GWでCognitoのトークンチェックも実施する。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437" x="665" y="1191.5825">1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略</text><line style="stroke:#181818;stroke-width:1.0;" x1="775" x2="817" y1="1224.7813" y2="1224.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="817" y1="1224.7813" y2="1237.7813"/><line style="stroke:#181818;stroke-width:1.0;" x1="776" x2="817" y1="1237.7813" y2="1237.7813"/><polygon fill="#181818" points="786,1233.7813,776,1237.7813,786,1241.7813,782,1237.7813" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="782" y="1219.7153">トークンチェック</text><line style="stroke:#181818;stroke-width:1.0;" x1="775" x2="817" y1="1282.0469" y2="1282.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="817" y1="1282.0469" y2="1295.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="776" x2="817" y1="1295.0469" y2="1295.0469"/><polygon fill="#181818" points="786,1291.0469,776,1295.0469,786,1299.0469,782,1295.0469" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="782" y="1261.8481">ユーザの規約</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="782" y="1276.981">状態を確認</text><polygon fill="#181818" points="667,1305.0469,657,1309.0469,667,1313.0469,663,1309.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1309.0469" y2="1309.0469"/><polygon fill="#181818" points="320,1319.0469,310,1323.0469,320,1327.0469,316,1323.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1323.0469" y2="1323.0469"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1352.1797" y2="1352.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1352.1797" y2="1365.1797"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1365.1797" y2="1365.1797"/><polygon fill="#181818" points="320,1361.1797,310,1365.1797,320,1369.1797,316,1365.1797" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="316" y="1347.1138">元々表示しようとしていた画面を表示</text><path d="M20,1380.1797 L86,1380.1797 L86,1387.3125 L76,1397.3125 L20,1397.3125 L20,1380.1797 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="332.1953" style="stroke:#000000;stroke-width:1.5;" width="1087" x="20" y="1380.1797"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="35" y="1393.2466">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="101" y="1392.3901">[新規の規約未確認状態]</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1433.5781" y2="1433.5781"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1433.5781" y2="1446.5781"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1446.5781" y2="1446.5781"/><polygon fill="#181818" points="320,1442.5781,310,1446.5781,320,1450.5781,316,1446.5781" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="316" y="1413.3794">規約画面表示</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="316" y="1428.5122">全画面モーダル</text><polygon fill="#181818" points="634,1471.7109,644,1475.7109,634,1479.7109,638,1475.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1475.7109" y2="1475.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="316" y="1470.645">規約情報取得</text><polygon fill="#181818" points="1010,1485.7109,1020,1489.7109,1010,1493.7109,1014,1489.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="1016" y1="1489.7109" y2="1489.7109"/><polygon fill="#181818" points="667,1499.7109,657,1503.7109,667,1507.7109,663,1503.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="1026" y1="1503.7109" y2="1503.7109"/><polygon fill="#181818" points="320,1513.7109,310,1517.7109,320,1521.7109,316,1517.7109" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1517.7109" y2="1517.7109"/><polygon fill="#181818" points="287,1557.9766,297,1561.9766,287,1565.9766,291,1561.9766" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="1561.9766" y2="1561.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="61" y="1541.7778">規約同意</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="61" y="1556.9106">チェックボックス押下</text><polygon fill="#181818" points="287,1587.1094,297,1591.1094,287,1595.1094,291,1591.1094" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="1591.1094" y2="1591.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="61" y="1586.0435">「確認した」ボタン押下</text><polygon fill="#181818" points="634,1616.2422,644,1620.2422,634,1624.2422,638,1620.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1620.2422" y2="1620.2422"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="316" y="1615.1763">規約同意日時更新API</text><polygon fill="#181818" points="753,1630.2422,763,1634.2422,753,1638.2422,757,1634.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="1634.2422" y2="1634.2422"/><polygon fill="#181818" points="667,1644.2422,657,1648.2422,667,1652.2422,663,1648.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1648.2422" y2="1648.2422"/><polygon fill="#181818" points="320,1658.2422,310,1662.2422,320,1666.2422,316,1662.2422" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1662.2422" y2="1662.2422"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1691.375" y2="1691.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1691.375" y2="1704.375"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1704.375" y2="1704.375"/><polygon fill="#181818" points="320,1700.375,310,1704.375,320,1708.375,316,1704.375" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="316" y="1686.3091">規約画面のモーダルを閉じる</text><!--MD5=[9b6cb4558cf202d1e8f0e9c1c2fcd310]
@startuml
title ログイン


' アクター定義
actor "ユーザ" as user
participant "クライアント端末\n(PCまたはスマホ)" as device
participant "認証基盤\n(Cognito)" as cognito
participant "CDN\n(CloudFront)" as cdn
participant "SonicHost API\n(API-Gateway)" as api
participant "SPA資材格納\n(S3)" as spa
participant "静的コンテンツ格納\n(S3)" as static

' 起動
user -> device ++ : 管理画面起動
device -> cdn ++
cdn -> spa ++ : バンドル資材要求
cdn <- spa - -
device <- cdn - -
device ->device : バンドル資材読み込み
device -> cognito ++ : トークンチェック用公開鍵要求
device <- cognito - -
device -> device: トークンチェック
' トークンチェック
alt トークン取得失敗 or トークンチェック失敗
    device -> device : ログイン画面表示
    alt パスワード忘れた場合
        user -> device : 「パスワードを忘れた場合はこちら」\nをクリック
        rnote right of device #GreenYellow
            パスワードリマインダフローを参照
        end note
    else 新規会員登録の場合
        user -> device: 「会員登録はこちら」\nをクリック
        rnote right of device #GreenYellow
            会員登録フローを参照
        end note
    end 
    device -> cognito ++ : ログイン確立要求\n(Initiate Auth)
    device <- - cognito - - : session等
    user -> device : ユーザ名・パスワード入力
    device -> cognito ++ : 認証(トークン発行依頼)\n(Responed to Auth Challenge)
    device -> cognito ++ : トークンチェック用公開鍵要求
    device <- cognito - -
    device <- - cognito - - : トークン
    device -> device : トークンチェック
end 
' 規約確認
rnote right of device #SkyBlue
    ログイン直後は以下のAPIを打鍵してグローバルな情報を取り込む
    * ユーザ情報取得API
    * サイト情報取得API
end note 
device -> cdn ++ : ユーザ情報取得API
cdn -> api ++ 
cdn <- api - -
device <- cdn - -
device -> cdn ++ : サイト情報取得API
cdn -> api ++
cdn <- api - -
device <- cdn - - 
device -> cdn ++ : 規約チェックAPI
cdn -> api ++
rnote right of cdn #SkyBlue
    CORS回避のため、API打鍵はCloudFrontを通す
    また、API-GWでCognitoのトークンチェックも実施する。
    1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略
end note
api -> api : トークンチェック
api -> api : ユーザの規約\n状態を確認
cdn <- api - -
device <- cdn - -
device -> device : 元々表示しようとしていた画面を表示
alt 新規の規約未確認状態
    device -> device : 規約画面表示\n全画面モーダル
    device -> cdn ++ : 規約情報取得
    cdn -> static ++ 
    cdn <- static - -
    device <- cdn - -
    user -> device : 規約同意\nチェックボックス押下
    user -> device : 「確認した」ボタン押下
    device -> cdn ++ : 規約同意日時更新API
    cdn -> api ++ 
    cdn <- api - -
    device <- cdn - -
    device -> device : 規約画面のモーダルを閉じる
end
@enduml

@startuml
title ログイン


actor "ユーザ" as user
participant "クライアント端末\n(PCまたはスマホ)" as device
participant "認証基盤\n(Cognito)" as cognito
participant "CDN\n(CloudFront)" as cdn
participant "SonicHost API\n(API-Gateway)" as api
participant "SPA資材格納\n(S3)" as spa
participant "静的コンテンツ格納\n(S3)" as static

user -> device ++ : 管理画面起動
device -> cdn ++
cdn -> spa ++ : バンドル資材要求
cdn <- spa - -
device <- cdn - -
device ->device : バンドル資材読み込み
device -> cognito ++ : トークンチェック用公開鍵要求
device <- cognito - -
device -> device: トークンチェック
alt トークン取得失敗 or トークンチェック失敗
    device -> device : ログイン画面表示
    alt パスワード忘れた場合
        user -> device : 「パスワードを忘れた場合はこちら」\nをクリック
        rnote right of device #GreenYellow
            パスワードリマインダフローを参照
        end note
    else 新規会員登録の場合
        user -> device: 「会員登録はこちら」\nをクリック
        rnote right of device #GreenYellow
            会員登録フローを参照
        end note
    end 
    device -> cognito ++ : ログイン確立要求\n(Initiate Auth)
    device <- - cognito - - : session等
    user -> device : ユーザ名・パスワード入力
    device -> cognito ++ : 認証(トークン発行依頼)\n(Responed to Auth Challenge)
    device -> cognito ++ : トークンチェック用公開鍵要求
    device <- cognito - -
    device <- - cognito - - : トークン
    device -> device : トークンチェック
end 
rnote right of device #SkyBlue
    ログイン直後は以下のAPIを打鍵してグローバルな情報を取り込む
    * ユーザ情報取得API
    * サイト情報取得API
end note 
device -> cdn ++ : ユーザ情報取得API
cdn -> api ++ 
cdn <- api - -
device <- cdn - -
device -> cdn ++ : サイト情報取得API
cdn -> api ++
cdn <- api - -
device <- cdn - - 
device -> cdn ++ : 規約チェックAPI
cdn -> api ++
rnote right of cdn #SkyBlue
    CORS回避のため、API打鍵はCloudFrontを通す
    また、API-GWでCognitoのトークンチェックも実施する。
    1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略
end note
api -> api : トークンチェック
api -> api : ユーザの規約\n状態を確認
cdn <- api - -
device <- cdn - -
device -> device : 元々表示しようとしていた画面を表示
alt 新規の規約未確認状態
    device -> device : 規約画面表示\n全画面モーダル
    device -> cdn ++ : 規約情報取得
    cdn -> static ++ 
    cdn <- static - -
    device <- cdn - -
    user -> device : 規約同意\nチェックボックス押下
    user -> device : 「確認した」ボタン押下
    device -> cdn ++ : 規約同意日時更新API
    cdn -> api ++ 
    cdn <- api - -
    device <- cdn - -
    device -> device : 規約画面のモーダルを閉じる
end
@enduml

PlantUML version 1.2022.14beta4(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>