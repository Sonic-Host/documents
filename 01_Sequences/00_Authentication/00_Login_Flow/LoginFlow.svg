<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1604px" preserveAspectRatio="none" style="width:1113px;height:1604px;background:#FFFFFF;" version="1.1" viewBox="0 0 1113 1604" width="1113px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="60" x="528" y="27.9951">ログイン</text><rect fill="#FFFFFF" height="1364.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="299" y="149.7266"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="292.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="659.5234"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="762.0547"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="549" y="791.1875"/><rect fill="#FFFFFF" height="57.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="163.7266"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="912.5859"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1270.0469"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1414.5781"/><rect fill="#FFFFFF" height="176.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="926.5859"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1428.5781"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="893" y="192.8594"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1022" y="1284.0469"/><rect fill="none" height="521.1953" style="stroke:#000000;stroke-width:1.5;" width="589.5" x="10" y="363.2578"/><rect fill="none" height="186.7344" style="stroke:#000000;stroke-width:1.5;" width="520" x="20" y="429.5234"/><rect fill="none" height="332.1953" style="stroke:#000000;stroke-width:1.5;" width="1087" x="20" y="1174.5156"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="54" x2="54" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="303.5" x2="303.5" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="548.5" x2="548.5" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="650.5" x2="650.5" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="769.5" x2="769.5" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="898" x2="898" y1="118.5938" y2="1523.7109"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1027" x2="1027" y1="118.5938" y2="1523.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="30" y="115.292">ユーザ</text><ellipse cx="54" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M54,58.7969 L54,85.7969 M41,66.7969 L67,66.7969 M54,85.7969 L41,100.7969 M54,85.7969 L67,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="30" y="1535.7061">ユーザ</text><ellipse cx="54" cy="1547.5078" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M54,1555.5078 L54,1582.5078 M41,1563.5078 L67,1563.5078 M54,1582.5078 L41,1597.5078 M54,1582.5078 L67,1597.5078 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="240.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="248" y="90.9951">クライアント端末</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="247.5" y="107.292">(PCまたはスマホ)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="127" x="240.5" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="112" x="248" y="1542.7061">クライアント端末</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="247.5" y="1559.0029">(PCまたはスマホ)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="508.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="521" y="90.9951">認証基盤</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="515.5" y="107.292">(Cognito)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="508.5" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="56" x="521" y="1542.7061">認証基盤</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67" x="515.5" y="1559.0029">(Cognito)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="599.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="635.5" y="90.9951">CDN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="606.5" y="107.292">(CloudFront)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103" x="599.5" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="635.5" y="1542.7061">CDN</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89" x="606.5" y="1559.0029">(CloudFront)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="712.5" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="720.5" y="90.9951">SonicHost API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="719.5" y="107.292">(API-Gateway)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="712.5" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99" x="720.5" y="1542.7061">SonicHost API</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101" x="719.5" y="1559.0029">(API-Gateway)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="849" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="856" y="90.9951">SPA資材格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="884" y="107.292">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="98" x="849" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="84" x="856" y="1542.7061">SPA資材格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="884" y="1559.0029">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="957" y="71"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="964" y="90.9951">静的コンテンツ格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1013" y="107.292">(S3)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="140" x="957" y="1522.7109"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="126" x="964" y="1542.7061">静的コンテンツ格納</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="28" x="1013" y="1559.0029">(S3)</text><rect fill="#FFFFFF" height="1364.9844" style="stroke:#181818;stroke-width:1.0;" width="10" x="299" y="149.7266"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="292.125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="659.5234"/><rect fill="#FFFFFF" height="72.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="544" y="762.0547"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="549" y="791.1875"/><rect fill="#FFFFFF" height="57.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="163.7266"/><rect fill="#FFFFFF" height="204.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="912.5859"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1270.0469"/><rect fill="#FFFFFF" height="42" style="stroke:#181818;stroke-width:1.0;" width="10" x="646" y="1414.5781"/><rect fill="#FFFFFF" height="176.7969" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="926.5859"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="765" y="1428.5781"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="893" y="192.8594"/><rect fill="#FFFFFF" height="14" style="stroke:#181818;stroke-width:1.0;" width="10" x="1022" y="1284.0469"/><polygon fill="#181818" points="287,145.7266,297,149.7266,287,153.7266,291,149.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="61" y="144.6606">管理画面起動</text><polygon fill="#181818" points="634,159.7266,644,163.7266,634,167.7266,638,163.7266" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="163.7266" y2="163.7266"/><polygon fill="#181818" points="881,188.8594,891,192.8594,881,196.8594,885,192.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="887" y1="192.8594" y2="192.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="663" y="187.7935">バンドル資材要求</text><polygon fill="#181818" points="667,202.8594,657,206.8594,667,210.8594,663,206.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="897" y1="206.8594" y2="206.8594"/><polygon fill="#181818" points="320,216.8594,310,220.8594,320,224.8594,316,220.8594" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="220.8594" y2="220.8594"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="249.9922" y2="249.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="249.9922" y2="262.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="262.9922" y2="262.9922"/><polygon fill="#181818" points="320,258.9922,310,262.9922,320,266.9922,316,262.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="316" y="244.9263">バンドル資材読み込み</text><polygon fill="#181818" points="532,288.125,542,292.125,532,296.125,536,292.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="292.125" y2="292.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="316" y="287.0591">トークンチェック用公開鍵要求</text><polygon fill="#181818" points="320,302.125,310,306.125,320,310.125,316,306.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="548" y1="306.125" y2="306.125"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="335.2578" y2="335.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="335.2578" y2="348.2578"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="348.2578" y2="348.2578"/><polygon fill="#181818" points="320,344.2578,310,348.2578,320,352.2578,316,348.2578" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="330.1919">トークンチェック</text><path d="M10,363.2578 L76,363.2578 L76,370.3906 L66,380.3906 L10,380.3906 L10,363.2578 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="521.1953" style="stroke:#000000;stroke-width:1.5;" width="589.5" x="10" y="363.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="25" y="376.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="231" x="91" y="375.4683">[トークン取得失敗 or トークンチェック失敗]</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="401.5234" y2="401.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="401.5234" y2="414.5234"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="414.5234" y2="414.5234"/><polygon fill="#181818" points="320,410.5234,310,414.5234,320,418.5234,316,414.5234" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="396.4575">ログイン画面表示</text><path d="M20,429.5234 L86,429.5234 L86,436.6563 L76,446.6563 L20,446.6563 L20,429.5234 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="186.7344" style="stroke:#000000;stroke-width:1.5;" width="520" x="20" y="429.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="35" y="442.5903">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="101" y="441.7339">[パスワード忘れた場合]</text><polygon fill="#181818" points="287,478.9219,297,482.9219,287,486.9219,291,482.9219" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="482.9219" y2="482.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="61" y="462.7231">「パスワードを忘れた場合はこちら」</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="61" y="477.856">をクリック</text><rect fill="#ADFF2F" height="23" style="stroke:#181818;stroke-width:0.5;" width="216" x="314" y="495.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208" x="318" y="511.9888">パスワードリマインダフローを参照</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="540" y1="525.0547" y2="525.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109" x="25" y="535.2651">[新規会員登録の場合]</text><polygon fill="#181818" points="287,571.125,297,575.125,287,579.125,291,575.125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="575.125" y2="575.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="61" y="554.9263">「会員登録はこちら」</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="61" y="570.0591">をクリック</text><rect fill="#ADFF2F" height="23" style="stroke:#181818;stroke-width:0.5;" width="138" x="314" y="588.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="318" y="604.1919">会員登録フローを参照</text><polygon fill="#181818" points="532,655.5234,542,659.5234,532,663.5234,536,659.5234" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="659.5234" y2="659.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="639.3247">ログイン確立要求</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="87" x="316" y="654.4575">(Initiate Auth)</text><polygon fill="#181818" points="320,684.6563,310,688.6563,320,692.6563,316,688.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="314" x2="548" y1="688.6563" y2="688.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="61" x="326" y="683.5903">session等</text><polygon fill="#181818" points="287,713.7891,297,717.7891,287,721.7891,291,717.7891" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="717.7891" y2="717.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="61" y="712.7231">ユーザ名・パスワード入力</text><polygon fill="#181818" points="532,758.0547,542,762.0547,532,766.0547,536,762.0547" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="538" y1="762.0547" y2="762.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="316" y="741.856">認証(トークン発行依頼)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192" x="316" y="756.9888">(Responed to Auth Challenge)</text><polygon fill="#181818" points="537,787.1875,547,791.1875,537,795.1875,541,791.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="543" y1="791.1875" y2="791.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182" x="316" y="786.1216">トークンチェック用公開鍵要求</text><polygon fill="#181818" points="320,801.1875,310,805.1875,320,809.1875,316,805.1875" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="543" y1="805.1875" y2="805.1875"/><polygon fill="#181818" points="320,830.3203,310,834.3203,320,838.3203,316,834.3203" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="314" x2="548" y1="834.3203" y2="834.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="326" y="829.2544">トークン</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="863.4531" y2="863.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="863.4531" y2="876.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="876.4531" y2="876.4531"/><polygon fill="#181818" points="320,872.4531,310,876.4531,320,880.4531,316,876.4531" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="316" y="858.3872">トークンチェック</text><polygon fill="#181818" points="634,908.5859,644,912.5859,634,916.5859,638,912.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="912.5859" y2="912.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="98" x="316" y="907.52">規約チェックAPI</text><polygon fill="#181818" points="753,922.5859,763,926.5859,753,930.5859,757,926.5859" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="926.5859" y2="926.5859"/><rect fill="#87CEEB" height="53" style="stroke:#181818;stroke-width:0.5;" width="445" x="661" y="939.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="281" x="665" y="955.6528">CORS回避のため、API打鍵はCloudFrontを通す</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="344" x="665" y="970.7856">また、API-GWでCognitoのトークンチェックも実施する。</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="437" x="665" y="985.9185">1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略</text><line style="stroke:#181818;stroke-width:1.0;" x1="775" x2="817" y1="1019.1172" y2="1019.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="817" y1="1019.1172" y2="1032.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="776" x2="817" y1="1032.1172" y2="1032.1172"/><polygon fill="#181818" points="786,1028.1172,776,1032.1172,786,1036.1172,782,1032.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="104" x="782" y="1014.0513">トークンチェック</text><line style="stroke:#181818;stroke-width:1.0;" x1="775" x2="817" y1="1076.3828" y2="1076.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="817" x2="817" y1="1076.3828" y2="1089.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="776" x2="817" y1="1089.3828" y2="1089.3828"/><polygon fill="#181818" points="786,1085.3828,776,1089.3828,786,1093.3828,782,1089.3828" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="782" y="1056.1841">ユーザの規約</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="65" x="782" y="1071.3169">状態を確認</text><polygon fill="#181818" points="667,1099.3828,657,1103.3828,667,1107.3828,663,1103.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1103.3828" y2="1103.3828"/><polygon fill="#181818" points="320,1113.3828,310,1117.3828,320,1121.3828,316,1117.3828" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1117.3828" y2="1117.3828"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1146.5156" y2="1146.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1146.5156" y2="1159.5156"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1159.5156" y2="1159.5156"/><polygon fill="#181818" points="320,1155.5156,310,1159.5156,320,1163.5156,316,1159.5156" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221" x="316" y="1141.4497">元々表示しようとしていた画面を表示</text><path d="M20,1174.5156 L86,1174.5156 L86,1181.6484 L76,1191.6484 L20,1191.6484 L20,1174.5156 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="332.1953" style="stroke:#000000;stroke-width:1.5;" width="1087" x="20" y="1174.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="35" y="1187.5825">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="120" x="101" y="1186.7261">[新規の規約未確認状態]</text><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1227.9141" y2="1227.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1227.9141" y2="1240.9141"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1240.9141" y2="1240.9141"/><polygon fill="#181818" points="320,1236.9141,310,1240.9141,320,1244.9141,316,1240.9141" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="316" y="1207.7153">規約画面表示</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="316" y="1222.8481">全画面モーダル</text><polygon fill="#181818" points="634,1266.0469,644,1270.0469,634,1274.0469,638,1270.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1270.0469" y2="1270.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78" x="316" y="1264.981">規約情報取得</text><polygon fill="#181818" points="1010,1280.0469,1020,1284.0469,1010,1288.0469,1014,1284.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="1016" y1="1284.0469" y2="1284.0469"/><polygon fill="#181818" points="667,1294.0469,657,1298.0469,667,1302.0469,663,1298.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="1026" y1="1298.0469" y2="1298.0469"/><polygon fill="#181818" points="320,1308.0469,310,1312.0469,320,1316.0469,316,1312.0469" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1312.0469" y2="1312.0469"/><polygon fill="#181818" points="287,1352.3125,297,1356.3125,287,1360.3125,291,1356.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="1356.3125" y2="1356.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="52" x="61" y="1336.1138">規約同意</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="130" x="61" y="1351.2466">チェックボックス押下</text><polygon fill="#181818" points="287,1381.4453,297,1385.4453,287,1389.4453,291,1385.4453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="54" x2="293" y1="1385.4453" y2="1385.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143" x="61" y="1380.3794">「確認した」ボタン押下</text><polygon fill="#181818" points="634,1410.5781,644,1414.5781,634,1418.5781,638,1414.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="640" y1="1414.5781" y2="1414.5781"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="316" y="1409.5122">規約同意日時更新API</text><polygon fill="#181818" points="753,1424.5781,763,1428.5781,753,1432.5781,757,1428.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="656" x2="759" y1="1428.5781" y2="1428.5781"/><polygon fill="#181818" points="667,1438.5781,657,1442.5781,667,1446.5781,663,1442.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="661" x2="769" y1="1442.5781" y2="1442.5781"/><polygon fill="#181818" points="320,1452.5781,310,1456.5781,320,1460.5781,316,1456.5781" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="314" x2="650" y1="1456.5781" y2="1456.5781"/><line style="stroke:#181818;stroke-width:1.0;" x1="309" x2="351" y1="1485.7109" y2="1485.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="351" x2="351" y1="1485.7109" y2="1498.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="310" x2="351" y1="1498.7109" y2="1498.7109"/><polygon fill="#181818" points="320,1494.7109,310,1498.7109,320,1502.7109,316,1498.7109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="169" x="316" y="1480.645">規約画面のモーダルを閉じる</text><!--MD5=[ed00def9dd7893b6b5e6ed17dac21537]
@startuml
title ログイン


' アクター定義
actor "ユーザ" as user
participant "クライアント端末\n(PCまたはスマホ)" as device
participant "認証基盤\n(Cognito)" as cognito
participant "CDN\n(CloudFront)" as cdn
participant "SonicHost API\n(API-Gateway)" as api
participant "SPA資材格納\n(S3)" as spa
participant "静的コンテンツ格納\n(S3)" as static

' 起動
user -> device ++ : 管理画面起動
device -> cdn ++
cdn -> spa ++ : バンドル資材要求
cdn <- spa - -
device <- cdn - -
device ->device : バンドル資材読み込み
device -> cognito ++ : トークンチェック用公開鍵要求
device <- cognito - -
device -> device: トークンチェック
' トークンチェック
alt トークン取得失敗 or トークンチェック失敗
    device -> device : ログイン画面表示
    alt パスワード忘れた場合
        user -> device : 「パスワードを忘れた場合はこちら」\nをクリック
        rnote right of device #GreenYellow
            パスワードリマインダフローを参照
        end note
    else 新規会員登録の場合
        user -> device: 「会員登録はこちら」\nをクリック
        rnote right of device #GreenYellow
            会員登録フローを参照
        end note
    end 
    device -> cognito ++ : ログイン確立要求\n(Initiate Auth)
    device <- - cognito - - : session等
    user -> device : ユーザ名・パスワード入力
    device -> cognito ++ : 認証(トークン発行依頼)\n(Responed to Auth Challenge)
    device -> cognito ++ : トークンチェック用公開鍵要求
    device <- cognito - -
    device <- - cognito - - : トークン
    device -> device : トークンチェック
end 
' 規約確認
device -> cdn ++ : 規約チェックAPI
cdn -> api ++
rnote right of cdn #SkyBlue
    CORS回避のため、API打鍵はCloudFrontを通す
    また、API-GWでCognitoのトークンチェックも実施する。
    1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略
end note
api -> api : トークンチェック
api -> api : ユーザの規約\n状態を確認
cdn <- api - -
device <- cdn - -
device -> device : 元々表示しようとしていた画面を表示
alt 新規の規約未確認状態
    device -> device : 規約画面表示\n全画面モーダル
    device -> cdn ++ : 規約情報取得
    cdn -> static ++ 
    cdn <- static - -
    device <- cdn - -
    user -> device : 規約同意\nチェックボックス押下
    user -> device : 「確認した」ボタン押下
    device -> cdn ++ : 規約同意日時更新API
    cdn -> api ++ 
    cdn <- api - -
    device <- cdn - -
    device -> device : 規約画面のモーダルを閉じる
end
@enduml

@startuml
title ログイン


actor "ユーザ" as user
participant "クライアント端末\n(PCまたはスマホ)" as device
participant "認証基盤\n(Cognito)" as cognito
participant "CDN\n(CloudFront)" as cdn
participant "SonicHost API\n(API-Gateway)" as api
participant "SPA資材格納\n(S3)" as spa
participant "静的コンテンツ格納\n(S3)" as static

user -> device ++ : 管理画面起動
device -> cdn ++
cdn -> spa ++ : バンドル資材要求
cdn <- spa - -
device <- cdn - -
device ->device : バンドル資材読み込み
device -> cognito ++ : トークンチェック用公開鍵要求
device <- cognito - -
device -> device: トークンチェック
alt トークン取得失敗 or トークンチェック失敗
    device -> device : ログイン画面表示
    alt パスワード忘れた場合
        user -> device : 「パスワードを忘れた場合はこちら」\nをクリック
        rnote right of device #GreenYellow
            パスワードリマインダフローを参照
        end note
    else 新規会員登録の場合
        user -> device: 「会員登録はこちら」\nをクリック
        rnote right of device #GreenYellow
            会員登録フローを参照
        end note
    end 
    device -> cognito ++ : ログイン確立要求\n(Initiate Auth)
    device <- - cognito - - : session等
    user -> device : ユーザ名・パスワード入力
    device -> cognito ++ : 認証(トークン発行依頼)\n(Responed to Auth Challenge)
    device -> cognito ++ : トークンチェック用公開鍵要求
    device <- cognito - -
    device <- - cognito - - : トークン
    device -> device : トークンチェック
end 
device -> cdn ++ : 規約チェックAPI
cdn -> api ++
rnote right of cdn #SkyBlue
    CORS回避のため、API打鍵はCloudFrontを通す
    また、API-GWでCognitoのトークンチェックも実施する。
    1つだけ丁寧に記載するが、以降はトークンチェック等のシーケンスを省略
end note
api -> api : トークンチェック
api -> api : ユーザの規約\n状態を確認
cdn <- api - -
device <- cdn - -
device -> device : 元々表示しようとしていた画面を表示
alt 新規の規約未確認状態
    device -> device : 規約画面表示\n全画面モーダル
    device -> cdn ++ : 規約情報取得
    cdn -> static ++ 
    cdn <- static - -
    device <- cdn - -
    user -> device : 規約同意\nチェックボックス押下
    user -> device : 「確認した」ボタン押下
    device -> cdn ++ : 規約同意日時更新API
    cdn -> api ++ 
    cdn <- api - -
    device <- cdn - -
    device -> device : 規約画面のモーダルを閉じる
end
@enduml

PlantUML version 1.2022.14beta1(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>